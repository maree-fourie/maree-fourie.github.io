<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Property Based Testing</title>
  <style type="text/css">
@charset "UTF-8";.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5;word-wrap:break-word;box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}.markdown-body a{color:#0366d6;background-color:transparent;text-decoration:none;-webkit-text-decoration-skip:objects}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body a:hover{text-decoration:underline}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body strong{font-weight:600}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em;margin:.67em 0;padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{padding-bottom:.3em;font-size:1.5em;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body hr{box-sizing:content-box;height:.25em;margin:24px 0;padding:0;overflow:hidden;background-color:#e1e4e8;border:0}.markdown-body hr::before{display:table;content:""}.markdown-body hr::after{display:table;clear:both;content:""}.markdown-body input{margin:0;overflow:visible;font:inherit;font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dd{margin-left:0}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;word-wrap:normal}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body table{display:block;width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body code{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code::after,.markdown-body code::before{letter-spacing:-.2em;content:"Â "}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code::after,.markdown-body pre code::before{content:normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body kbd{box-shadow:inset 0 -1px 0 #959da5;display:inline-block;padding:3px 5px;font:11px/10px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#444d56;vertical-align:middle;background-color:#fcfcfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body::before{display:table;content:""}.markdown-body::after{display:table;clear:both;content:""}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.Alert,.Error,.Note,.Success,.Warning{padding:11px;margin-bottom:24px;border-style:solid;border-width:1px;border-radius:4px}.Alert p,.Error p,.Note p,.Success p,.Warning p{margin-top:0}.Alert p:last-child,.Error p:last-child,.Note p:last-child,.Success p:last-child,.Warning p:last-child{margin-bottom:0}.Alert{color:#246;background-color:#e2eef9;border-color:#bac6d3}.Warning{color:#4c4a42;background-color:#fff9ea;border-color:#dfd8c2}.Error{color:#911;background-color:#fcdede;border-color:#d2b2b2}.Success{color:#22662c;background-color:#e2f9e5;border-color:#bad3be}.Note{color:#2f363d;background-color:#f6f8fa;border-color:#d5d8da}.Alert h1,.Alert h2,.Alert h3,.Alert h4,.Alert h5,.Alert h6{color:#246;margin-bottom:0}.Warning h1,.Warning h2,.Warning h3,.Warning h4,.Warning h5,.Warning h6{color:#4c4a42;margin-bottom:0}.Error h1,.Error h2,.Error h3,.Error h4,.Error h5,.Error h6{color:#911;margin-bottom:0}.Success h1,.Success h2,.Success h3,.Success h4,.Success h5,.Success h6{color:#22662c;margin-bottom:0}.Note h1,.Note h2,.Note h3,.Note h4,.Note h5,.Note h6{color:#2f363d;margin-bottom:0}.Alert h1:first-child,.Alert h2:first-child,.Alert h3:first-child,.Alert h4:first-child,.Alert h5:first-child,.Alert h6:first-child,.Error h1:first-child,.Error h2:first-child,.Error h3:first-child,.Error h4:first-child,.Error h5:first-child,.Error h6:first-child,.Note h1:first-child,.Note h2:first-child,.Note h3:first-child,.Note h4:first-child,.Note h5:first-child,.Note h6:first-child,.Success h1:first-child,.Success h2:first-child,.Success h3:first-child,.Success h4:first-child,.Success h5:first-child,.Success h6:first-child,.Warning h1:first-child,.Warning h2:first-child,.Warning h3:first-child,.Warning h4:first-child,.Warning h5:first-child,.Warning h6:first-child{margin-top:0}h1.title,p.subtitle{text-align:center}h1.title.followed-by-subtitle{margin-bottom:0}p.subtitle{font-size:1.5em;font-weight:600;line-height:1.25;margin-top:0;margin-bottom:16px;padding-bottom:.3em}div.line-block{white-space:pre-line}
  </style>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<article class="markdown-body">
<header>

<a style="float: left; margin-top: 25px" href="https://maree-fourie.github.io/">Home</a>
<h1 class="title">Property Based Testing</h1>

</header>
<hr>
<nav id="TOC">
<h1 class="toc-title">Contents</h1>
<ul>
<li><a href="#property-based-testing"><span class="toc-section-number">1</span> Property Based Testing</a></li>
<li><a href="#properties"><span class="toc-section-number">2</span> Properties</a><ul>
<li><a href="#conditional-properties"><span class="toc-section-number">2.1</span> Conditional Properties</a></li>
<li><a href="#quantified-properties"><span class="toc-section-number">2.2</span> Quantified Properties</a></li>
<li><a href="#expecting-exceptions"><span class="toc-section-number">2.3</span> Expecting exceptions</a></li>
<li><a href="#observing-test-cases"><span class="toc-section-number">2.4</span> Observing Test Cases</a><ul>
<li><a href="#counting-trivial-cases"><span class="toc-section-number">2.4.1</span> Counting Trivial Cases</a></li>
<li><a href="#classifying-test-cases"><span class="toc-section-number">2.4.2</span> Classifying Test Cases</a></li>
<li><a href="#collecting-data-values"><span class="toc-section-number">2.4.3</span> Collecting Data Values</a></li>
<li><a href="#combining-observations"><span class="toc-section-number">2.4.4</span> Combining Observations</a></li>
</ul></li>
<li><a href="#combined-properties"><span class="toc-section-number">2.5</span> Combined Properties</a></li>
</ul></li>
<li><a href="#generators-shrinkers-and-arbitrary-instances"><span class="toc-section-number">3</span> Generators, Shrinkers and Arbitrary Instances</a><ul>
<li><a href="#generators"><span class="toc-section-number">3.1</span> Generators</a><ul>
<li><a href="#constant"><span class="toc-section-number">3.1.1</span> Constant</a></li>
<li><a href="#choosing-between-alternatives"><span class="toc-section-number">3.1.2</span> Choosing between alternatives</a></li>
<li><a href="#test-data-size"><span class="toc-section-number">3.1.3</span> Test data size</a></li>
<li><a href="#generating-recursive-data-types"><span class="toc-section-number">3.1.4</span> Generating recursive data types</a></li>
<li><a href="#generator-functions"><span class="toc-section-number">3.1.5</span> Generator functions</a></li>
</ul></li>
<li><a href="#shrinker"><span class="toc-section-number">3.2</span> Shrinker</a></li>
<li><a href="#arbitrary"><span class="toc-section-number">3.3</span> Arbitrary</a><ul>
<li><a href="#arb-methods"><span class="toc-section-number">3.3.1</span> <code>Arb</code> methods</a></li>
</ul></li>
</ul></li>
<li><a href="#bibliography"><span class="toc-section-number">4</span> Bibliography</a></li>
</ul>
</nav>
<hr>
<h1 id="property-based-testing"><span class="header-section-number">1</span> Property Based Testing</h1>
<p>Using unit testing to verify code correct is not always effective. The code contracts encode the specification, we there for only have to show that the code we wrote does not breach the contract to verify the code.</p>
<p>We can represent a program or section of a program, unit, as a mathematical function <span class="math inline">(<em>f</em>)</span>. All possible legal permutations of inputs are the functionâs domain <span class="math inline">(<em>I</em>)</span> and the outputs are the functionâs range <span class="math inline">(<em>O</em>)</span>.</p>
<p><br /><span class="math display"><em>f</em>â:â<em>I</em>âââ<em>O</em></span><br /></p>
<p>It would be impractical to write unit tests that cover the complete domain of a unit. Instead we randomly select inputs from the domain. When we tests smaller units, random testing is adequate <a href="####-2">[2]</a>. We are not going to verify the outputs because, if the outputs adhere to the contracts we assume the outputs are valid. This will eliminate the oracle problem <a href="####-1">[1]</a> <a href="####-2">[2]</a>.</p>
<p>We will be using FsCheck to select the random inputs. FsCheck is a .net implementation of QuickCheck <a href="####-3">[3]</a>. We use the xUnit test framework to make writing the test more convenient.</p>
<p>The tests have two parts, the input generators and tests action. We first look at the generators. We group the test inputs using tuples. The generator code filters the generated value according to the contracts.</p>
<h1 id="properties"><span class="header-section-number">2</span> Properties</h1>
<p>Properties are created in methods marked as <code>[Property]</code> and returning a <code>Property</code>. Properties must not have generic types. Properties can have any number of parameters.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb1-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Property_method</span>(<span class="dt">int</span>[] values, â¯)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    â¯</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    <span class="kw">return</span> â¯.<span class="fu">ToProperty</span>();</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">}</a></code></pre></div>
<p>Properties can be created from:</p>
<ul>
<li>a boolean value indicating tests status;</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb2-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Reverse_Reverse_has_no_effect</span>(<span class="dt">int</span>[] values)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">   <span class="dt">var</span> list = <span class="kw">new</span> List&lt;<span class="dt">int</span>&gt;(values);</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">   list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">   list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">   <span class="kw">return</span> list.<span class="fu">SequenceEqual</span>(values).<span class="fu">ToProperty</span>();</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">}</a></code></pre></div>
<ul>
<li>a function returning a boolean indicating test status;</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb3-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Reverse_Reverse_has_no_effect</span>(<span class="dt">int</span>[] values)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">   Func&lt;<span class="dt">bool</span>&gt; test = () =&gt;</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">   {</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">      <span class="dt">var</span> list = <span class="kw">new</span> List&lt;<span class="dt">int</span>&gt;(values);</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">      list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">      list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">      <span class="kw">return</span> list.<span class="fu">SequenceEqual</span>(values);</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">   };</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">   <span class="kw">return</span> test.<span class="fu">ToProperty</span>();</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">}</a></code></pre></div>
<ul>
<li>an action with any number of properties. Exceptions indicate test failure.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb4-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Reverse_Reverse_has_no_effect</span>(<span class="dt">int</span>[] values)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">   Action test = () =&gt;</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">   {</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">      <span class="dt">var</span> list = <span class="kw">new</span> List&lt;<span class="dt">int</span>&gt;(values);</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">      list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">      list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">      <span class="kw">if</span> (list.<span class="fu">SequenceEqual</span>(values))</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">            <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Exception</span>(<span class="st">&quot;The reversal failed&quot;</span>);</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">   };</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">   <span class="kw">return</span> test.<span class="fu">ToProperty</span>();</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">}</a></code></pre></div>
<h2 id="conditional-properties"><span class="header-section-number">2.1</span> Conditional Properties</h2>
<p>To use conditional properties the tests have to be warped in a <code>Func</code> or <code>Action</code>. Test cases that do not satisfy the conditions are discarded. Test cases are generated unit the required number of tests cases satisfying the conditions are run. (There is a caveat: https://github.com/fscheck/FsCheck/issues/245)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb5-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Dividing_by_self_is_1</span>(<span class="dt">int</span> x)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    Func&lt;<span class="dt">bool</span>&gt; test = () =&gt;</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    {</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">        <span class="dt">var</span> quotient = MyMath.<span class="fu">Divide</span>(x, x);</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">        <span class="kw">return</span> quotient == <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">    };</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">    <span class="kw">return</span> test.<span class="fu">When</span>(x != <span class="dv">0</span>);</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">}</a></code></pre></div>
<h2 id="quantified-properties"><span class="header-section-number">2.2</span> Quantified Properties</h2>
<p>You create your own input using <a href="#generators-shrinkers-and-arbitrary-instances">generators, shrinkers and arbitrary instances</a>.</p>
<h2 id="expecting-exceptions"><span class="header-section-number">2.3</span> Expecting exceptions</h2>
<p>To test that code throws an exception.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb6-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Dividing_By_Zero_Raises_Exception</span>(<span class="dt">int</span> x)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">    <span class="kw">return</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">        Prop</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">        .<span class="fu">Throws</span>&lt;DivideByZeroException, <span class="dt">int</span>&gt;(</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">            <span class="kw">new</span> Lazy&lt;<span class="dt">int</span>&gt;(() =&gt; MyMath.<span class="fu">Divide</span>(x, <span class="dv">0</span>)));</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">}</a></code></pre></div>
<h2 id="observing-test-cases"><span class="header-section-number">2.4</span> Observing Test Cases</h2>
<p>If test cases are not well distributed the test results may be invalid. Filtering tests cases can skew test case distribution.</p>
<h3 id="counting-trivial-cases"><span class="header-section-number">2.4.1</span> Counting Trivial Cases</h3>
<p>Test cases that do not properly test the code or only tests a small part of the code are considered trivial.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb7-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Reverse_Reverse_has_no_effect</span>(<span class="dt">int</span>[] values)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    Func&lt;<span class="dt">bool</span>&gt; test = () =&gt;</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    {</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">        <span class="dt">var</span> list = <span class="kw">new</span> List&lt;<span class="dt">int</span>&gt;(values);</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">        list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">        list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">        <span class="kw">return</span> list.<span class="fu">SequenceEqual</span>(values);</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">    };</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">    <span class="kw">return</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">        test</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">        .<span class="fu">Trivial</span>(values.<span class="fu">Length</span> &lt; <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">}</a></code></pre></div>
<p><strong>Output</strong> :</p>
<pre><code>Ok, passed 100 tests (3% trivial)</code></pre>
<h3 id="classifying-test-cases"><span class="header-section-number">2.4.2</span> Classifying Test Cases</h3>
<p>You can also create a more detailed breakdown of the test cases by classifying them into categories.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb9-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Dividing_by_self_is_1</span>(<span class="dt">int</span> x)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    Func&lt;<span class="dt">bool</span>&gt; test = () =&gt;</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    {</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">        <span class="dt">var</span> quotient = MyMath.<span class="fu">Divide</span>(x, x);</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">        <span class="kw">return</span> quotient == <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    };</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    <span class="kw">return</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">        test</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">        .<span class="fu">When</span>(x != <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">        .<span class="fu">Classify</span>(x &gt; <span class="dv">0</span>, <span class="st">&quot;Positive numbers&quot;</span>)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">        .<span class="fu">Classify</span>(x &lt; <span class="dv">0</span>, <span class="st">&quot;Negative numbers&quot;</span>);</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">}</a></code></pre></div>
<p><strong>Output</strong>:</p>
<pre><code>Ok, passed 100 tests.
54% Negative numbers.
46% Positive numbers.</code></pre>
<h3 id="collecting-data-values"><span class="header-section-number">2.4.3</span> Collecting Data Values</h3>
<p>If you donât want to divide test cases into categories but just want to collect all the values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb11-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Reverse_Reverse_has_no_effect</span>(<span class="dt">int</span>[] values)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    Func&lt;<span class="dt">bool</span>&gt; test = () =&gt;</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    {</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">        <span class="dt">var</span> list = <span class="kw">new</span> List&lt;<span class="dt">int</span>&gt;(values);</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">        list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">        list.<span class="fu">Reverse</span>();</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">        <span class="kw">return</span> list.<span class="fu">SequenceEqual</span>(values);</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">    };</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">    <span class="kw">return</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">        test</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">        .<span class="fu">Collect</span>($<span class="st">&quot;List length: {values.Length}&quot;</span>);</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">}</a></code></pre></div>
<p><strong>Output</strong>:</p>
<pre><code>Ok, passed 100 tests.
6% &quot;List length: 1&quot;.
4% &quot;List length: 22&quot;.
4% &quot;List length: 2&quot;.
â¯</code></pre>
<h3 id="combining-observations"><span class="header-section-number">2.4.4</span> Combining Observations</h3>
<p>You can use all of the observations together.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb13-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">Dividing_by_self_is_1</span>(<span class="dt">int</span> x)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">    Func&lt;<span class="dt">bool</span>&gt; test = () =&gt;</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    {</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">        <span class="dt">var</span> quotient = MyMath.<span class="fu">Divide</span>(x, x);</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">        <span class="kw">return</span> quotient == <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">    };</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">    <span class="kw">return</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">        test</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">        .<span class="fu">When</span>(x != <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">        .<span class="fu">Classify</span>(x &gt; <span class="dv">0</span>, <span class="st">&quot;Positive numbers&quot;</span>)</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">        .<span class="fu">Classify</span>(x &lt; <span class="dv">0</span>, <span class="st">&quot;Negative numbers&quot;</span>)</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">        .<span class="fu">Trivial</span>(x == <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">        .<span class="fu">Collect</span>($<span class="st">&quot;Value: {x}&quot;</span>);</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">}</a></code></pre></div>
<p><strong>Output</strong></p>
<pre><code>Ok, passed 100 tests.
5% &quot;Value: -5&quot;, Negative numbers.
4% &quot;Value: 4&quot;, Positive numbers.
â¯
1% &quot;Value: 1&quot;, trivial, Positive numbers.
â¯</code></pre>
<h2 id="combined-properties"><span class="header-section-number">2.5</span> Combined Properties</h2>
<p>A test case can check more than one property.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb15-1" data-line-number="1">[Property]</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">public</span> Property <span class="fu">When_dividing</span>(PositiveInt x, PositiveInt y)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    <span class="dt">var</span> quotient = MyMath.<span class="fu">Divide</span>(x.<span class="fu">Get</span>, y.<span class="fu">Get</span>);</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="kw">return</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">        (quotient &lt;= x.<span class="fu">Get</span>)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">            .<span class="fu">Label</span>(<span class="st">&quot;Quotient must be â¤ to dividend.&quot;</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">        .<span class="fu">And</span>(quotient * y.<span class="fu">Get</span> == x.<span class="fu">Get</span>)</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">            .<span class="fu">Label</span>(<span class="st">&quot;Quotient Ã divisor = dividend&quot;</span>);</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">}</a></code></pre></div>
<p>This fails. The error message show the propertyâs label.</p>
<p><strong>Output</strong>:</p>
<pre><code>Message:
    FsCheck.Xunit.PropertyFailedException :
    Falsifiable, after 8 tests (0 shrinks) (StdGen (1029087747,296805295)):
    Label of failing property: Quotient Ã divisor = dividend
    Original:
    (PositiveInt 1, PositiveInt 2)</code></pre>
<h1 id="generators-shrinkers-and-arbitrary-instances"><span class="header-section-number">3</span> Generators, Shrinkers and Arbitrary Instances</h1>
<p>FsCheck provides default generators for some often used types. You will have to define your own generator for new types you create. To create your own generator you can use the <code>Gen&lt;T&gt;</code> class and Linq methods.</p>
<p>Shrinkers are used to narrow down the failing test case given the initial random test case.</p>
<p>FsCheck uses <code>Arbitrary</code> to package a generator and shrinker for a type. You can define custom <code>Arbitrary</code> instances for you own types by defining static members that return an instance of <code>Arbitrary&lt;'a&gt;</code>. FsCheck organizes <code>Arbitrary</code> instances in a <code>&lt;Type, Arbitrary&gt;</code> dictionary.</p>
<h2 id="generators"><span class="header-section-number">3.1</span> Generators</h2>
<p>Generators are contracted from the <code>choose</code> function. <code>choose</code> picks a random value from an interval, with a uniform distribution.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">public</span> Gen&lt;T&gt; ChooseFrom&lt;T&gt;(T[] list)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">    <span class="kw">return</span> Gen</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">        .<span class="fu">Choose</span>(<span class="dv">0</span>, list.<span class="fu">Length</span> - <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">        .<span class="fu">Select</span>(i =&gt; list[i]);</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">}</a></code></pre></div>
<h3 id="constant"><span class="header-section-number">3.1.1</span> Constant</h3>
<p><code>Gen.Constant&lt;T&gt;(T value)</code> always returns the same value.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="dt">var</span> generator = Gen.<span class="fu">Constant</span>(<span class="dv">5</span>);</a></code></pre></div>
<h3 id="choosing-between-alternatives"><span class="header-section-number">3.1.2</span> Choosing between alternatives</h3>
<h4 id="equal-probability"><span class="header-section-number">3.1.2.1</span> Equal probability</h4>
<p><code>Gen.OneOf&lt;T&gt;(params Gen&lt;T&gt;[] generators)</code> picks one of the generators with equal probability.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="dt">var</span> generator =</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">    Gen.<span class="fu">OneOf</span>(</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">        Gen.<span class="fu">Constant</span>(<span class="st">&quot;a&quot;</span>),</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">        Gen.<span class="fu">Constant</span>(<span class="st">&quot;b&quot;</span>));</a></code></pre></div>
<h4 id="define-distribution"><span class="header-section-number">3.1.2.2</span> Define distribution</h4>
<p><code>Gen.Frequency&lt;T&gt;(params Tuple&lt;int, Gen&lt;T&gt;&gt;[] weightedValues)</code> picks a one of the generators with weighted probability.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="dt">var</span> generator =</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">    Gen.<span class="fu">Frequency</span>(</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">        Tuple.<span class="fu">Create</span>(<span class="dv">1</span>, Gen.<span class="fu">Constant</span>(<span class="st">&quot;a&quot;</span>)),</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">        Tuple.<span class="fu">Create</span>(<span class="dv">2</span>, Gen.<span class="fu">Constant</span>(<span class="st">&quot;b&quot;</span>)));</a></code></pre></div>
<h3 id="test-data-size"><span class="header-section-number">3.1.3</span> Test data size</h3>
<p>Generators have an implicit size parameter. Testing starts with small test cases and progresses to larger test cases.</p>
<p>Generators can interpret the size parameter as they please or ignore it completely.</p>
<p>Size is accessed via the <code>Gen.Sized&lt;T&gt;(Func&lt;int, Gen&lt;T&gt;&gt; sizedGen)</code> function.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="dt">var</span> generator =</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">    Gen.<span class="fu">Sized</span>(size =&gt; Gen.<span class="fu">Choose</span>(<span class="dv">0</span>, size));</a></code></pre></div>
<h3 id="generating-recursive-data-types"><span class="header-section-number">3.1.4</span> Generating recursive data types</h3>
<p>Recursive data types can be generated using <code>OneOf</code> or <code>Frequency</code> to choose between constructors.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">public</span> <span class="kw">static</span> Gen&lt;Tree&gt; <span class="fu">SafeTree</span>()</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">    <span class="kw">return</span> Gen.<span class="fu">Sized</span>(size =&gt; <span class="fu">TreeBuilder</span>(size));</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">    Gen&lt;Tree&gt; <span class="fu">TreeBuilder</span>(<span class="dt">int</span> size)</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">    {</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">        <span class="kw">if</span> (size == <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">            <span class="kw">return</span> Arb.<span class="fu">Generate</span>&lt;<span class="dt">int</span>&gt;().<span class="fu">Select</span>(i =&gt; (Tree)<span class="kw">new</span> <span class="fu">Leaf</span>(i));</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">        <span class="kw">else</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10">            <span class="kw">return</span> Gen.<span class="fu">OneOf</span>(</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">                Arb.<span class="fu">Generate</span>&lt;<span class="dt">int</span>&gt;()</a>
<a class="sourceLine" id="cb22-12" data-line-number="12">                    .<span class="fu">Select</span>(i =&gt; (Tree)<span class="kw">new</span> <span class="fu">Leaf</span>(i)),</a>
<a class="sourceLine" id="cb22-13" data-line-number="13">                Gen.<span class="fu">Two</span>(<span class="fu">TreeBuilder</span>(size / <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb22-14" data-line-number="14">                    .<span class="fu">Select</span>(t =&gt; (Tree)<span class="kw">new</span> <span class="fu">Branch</span>(t.<span class="fu">Item1</span>, t.<span class="fu">Item2</span>)));</a>
<a class="sourceLine" id="cb22-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb22-16" data-line-number="16">}</a></code></pre></div>
<h3 id="generator-functions"><span class="header-section-number">3.1.5</span> Generator functions</h3>
<dl>
<dt>Apply</dt>
<dd>Apply the given Gen function to the given generator, aka the applicative &lt;*&gt; operator
</dd>
<dd><code>Gen&lt;b&gt; Apply&lt;a, b&gt;(Gen&lt;FSharpFunc&lt;a, b&gt;&gt; f, Gen&lt;a&gt; gn)</code>
</dd>
<dt>Array2DOf</dt>
<dd>Generates a 2D array.
</dd>
<dd><code>Gen&lt;a[,]&gt; Array2DOf&lt;a&gt;(Gen&lt;a&gt; g)</code>
</dd>
<dd><code>Gen&lt;a[,]&gt; Array2DOf&lt;a&gt;(int rows, int cols, Gen&lt;a&gt; g)</code>
</dd>
<dt>ArrayOf</dt>
<dd>Generates an array
</dd>
<dd><code>Gen&lt;a[]&gt; ArrayOf&lt;a&gt;(int n, Gen&lt;a&gt; g)</code>
</dd>
<dd><code>Gen&lt;a[]&gt; ArrayOf&lt;a&gt;(Gen&lt;a&gt; g)</code>
</dd>
<dt>Choose</dt>
<dd>Generates an integer between l and h, inclusive.
</dd>
<dd><code>Gen&lt;int&gt; Choose(int l, int h)</code>
</dd>
<dt>Collect</dt>
<dd>Traverse the given enumerable/array into a generator to create generators.
</dd>
<dd><code>Gen&lt;IEnumerable&lt;b&gt;&gt; Collect&lt;a, b&gt;(FSharpFunc&lt;a, Gen&lt;b&gt;&gt; f, IEnumerable&lt;a&gt; l)</code>
</dd>
<dd><code>Gen&lt;b[]&gt; CollectToArray&lt;a, b&gt;(FSharpFunc&lt;a, Gen&lt;b&gt;&gt; f, params a[] xs)</code>
</dd>
<dd><code>Gen&lt;FSharpList&lt;b&gt;&gt; CollectToList&lt;a, b&gt;(FSharpFunc&lt;a, Gen&lt;b&gt;&gt; f, IEnumerable&lt;a&gt; l)</code>
</dd>
<dt>Constant</dt>
<dd>Always generate the same instance v. See also fresh.
</dd>
<dd><code>Gen&lt;a&gt; Constant&lt;a&gt;(a v)</code>
</dd>
<dt>Elements</dt>
<dd>Build a generator that randomly generates one of the values in the given non-empty seq.
</dd>
<dd><code>Gen&lt;a&gt; Elements&lt;a&gt;(params a[] values)</code>
</dd>
<dd><code>Gen&lt;a&gt; Elements&lt;a&gt;(IEnumerable&lt;a&gt; xs)</code>
</dd>
<dt>Eval</dt>
<dd>Generates a value of the give size with the given seed
</dd>
<dd><code>a Eval&lt;a&gt;(int size, Random.StdGen seed, Gen&lt;a&gt; _arg1)</code>
</dd>
<dt>Filter</dt>
<dd>Generates a value that satisfies a predicate. This function keeps re-trying by increasing the size of the original generator ad infinitum. The <code>filter</code> function is an alias for the <code>where</code> function.
</dd>
<dd><code>Gen&lt;a&gt; Filter&lt;a&gt;(FSharpFunc&lt;a, bool&gt; predicate, Gen&lt;a&gt; generator)</code>
</dd>
<dd><code>Gen&lt;a&gt; Where&lt;a&gt;(FSharpFunc&lt;a, bool&gt; predicate, Gen&lt;a&gt; generator)</code>
</dd>
</dl>
<p>TryFilter :Tries to generate a value that satisfies a predicate. The <code>tryFilter</code> function is an alias for the <code>tryWhere</code> function. This function âgives upâ by generating None if the given original generator did not generate any values that satisfied the predicate, after trying to get values by increasing its size. : <code>Gen&lt;FSharpOption&lt;a&gt;&gt; TryFilter&lt;a&gt;(FSharpFunc&lt;a, bool&gt; predicate, Gen&lt;a&gt; generator)</code> : <code>Gen&lt;FSharpOption&lt;a&gt;&gt; TryWhere&lt;a&gt;(FSharpFunc&lt;a, bool&gt; predicate, Gen&lt;a&gt; generator)</code></p>
<dl>
<dt>Tuple</dt>
<dd>Build a generator that generates a tuple of the values generated by the given generator.
</dd>
<dd><code>Gen&lt;Tuple&lt;a, a, a, a&gt;&gt; Four&lt;a&gt;(Gen&lt;a&gt; g)</code>
</dd>
<dd><code>Gen&lt;Tuple&lt;a, a, a&gt;&gt; Three&lt;a&gt;(Gen&lt;a&gt; g)</code>
</dd>
<dd><code>Gen&lt;Tuple&lt;a, a&gt;&gt; Two&lt;a&gt;(Gen&lt;a&gt; g)</code>
</dd>
<dt>Frequency</dt>
<dd>Build a generator that generates a value from one of the generators in the given non-empty seq, with given probabilities. The sum of the probabilities must be larger than zero.
</dd>
<dd><code>Gen&lt;a&gt; Frequency&lt;a&gt;(params WeightAndValue&lt;Gen&lt;a&gt;&gt;[] weightedValues)</code>
</dd>
<dd><code>Gen&lt;a&gt; Frequency&lt;a&gt;(params Tuple&lt;int, Gen&lt;a&gt;&gt;[] weightedValues)</code>
</dd>
<dd><code>Gen&lt;a&gt; Frequency&lt;a&gt;(IEnumerable&lt;Tuple&lt;int, Gen&lt;a&gt;&gt;&gt; xs)</code>
</dd>
<dd><code>Gen&lt;a&gt; Frequency&lt;a&gt;(IEnumerable&lt;WeightAndValue&lt;Gen&lt;a&gt;&gt;&gt; weightedValues)</code>
</dd>
<dt>Fresh</dt>
<dd>Generate a fresh instance every time the generator is called. Useful for mutable objects. See also constant.
</dd>
<dd><code>Gen&lt;a&gt; Fresh&lt;a&gt;(FSharpFunc&lt;Unit, a&gt; fv)</code>
</dd>
<dd><code>Gen&lt;a&gt; Fresh&lt;a&gt;(Func&lt;a&gt; fv)</code>
</dd>
<dt>GrowingElements</dt>
<dd>Build a generator that takes a non-empty sequence and randomly generates one of the values among an initial segment of that sequence. The size of this initial segment increases with the size parameter.
</dd>
<dd><code>Gen&lt;a&gt; GrowingElements&lt;a&gt;(IEnumerable&lt;a&gt; xs)</code>
</dd>
<dt>ListOf</dt>
<dd>Generates a list of random/given length
</dd>
<dd><code>Gen&lt;FSharpList&lt;a&gt;&gt; ListOf&lt;a&gt;(Gen&lt;a&gt; gn)</code>
</dd>
<dd><code>Gen&lt;FSharpList&lt;a&gt;&gt; ListOf&lt;a&gt;(int n, Gen&lt;a&gt; arb)</code>
</dd>
<dt>NonEmptyListOf</dt>
<dd>Generates a non-empty list of random length. The maximum length depends on the size parameter.
</dd>
<dd><code>Gen&lt;FSharpList&lt;a&gt;&gt; NonEmptyListOf&lt;a&gt;(Gen&lt;a&gt; gn)</code>
</dd>
<dt>SubListOf</dt>
<dd>Generates sublists of the given values
</dd>
<dd><code>Gen&lt;IList&lt;a&gt;&gt; SubListOf&lt;a&gt;(IEnumerable&lt;a&gt; s)</code>
</dd>
<dd><code>Gen&lt;IList&lt;a&gt;&gt; SubListOf&lt;a&gt;(params a[] s)</code>
</dd>
<dd><code>Gen&lt;FSharpList&lt;a&gt;&gt; SubListOfToList&lt;a&gt;(IEnumerable&lt;a&gt; l)</code>
</dd>
<dt>Map</dt>
<dd>Apply the function f to the value in the generator, yielding a new generator.
</dd>
<dd><code>Gen&lt;b&gt; Map&lt;a, b&gt;(FSharpFunc&lt;a, b&gt; f, Gen&lt;a&gt; gen)</code>
</dd>
<dt>MapX</dt>
<dd>Map the given function over values to a function over generators of those values.
</dd>
<dd><code>Gen&lt;c&gt; Map2&lt;a, b, c&gt;(FSharpFunc&lt;a, FSharpFunc&lt;b, c&gt;&gt; f, Gen&lt;a&gt; a, Gen&lt;b&gt; b)</code>
</dd>
<dd><code>Gen&lt;d&gt; Map3&lt;a, b, c, d&gt;(FSharpFunc&lt;a, FSharpFunc&lt;b, FSharpFunc&lt;c, d&gt;&gt;&gt; f, Gen&lt;a&gt; a, Gen&lt;b&gt; b, Gen&lt;c&gt; c)</code>
</dd>
<dd><code>Gen&lt;e&gt; Map4&lt;a, b, c, d, e&gt;(FSharpFunc&lt;a, FSharpFunc&lt;b, FSharpFunc&lt;c, FSharpFunc&lt;d, e&gt;&gt;&gt;&gt; f, Gen&lt;a&gt; a, Gen&lt;b&gt; b, Gen&lt;c&gt; c, Gen&lt;d&gt; d)</code>
</dd>
<dd><code>Gen&lt;f&gt; Map5&lt;a, b, c, d, e, f&gt;(FSharpFunc&lt;a, FSharpFunc&lt;b, FSharpFunc&lt;c, FSharpFunc&lt;d, FSharpFunc&lt;e, f&gt;&gt;&gt;&gt;&gt; f, Gen&lt;a&gt; a, Gen&lt;b&gt; b, Gen&lt;c&gt; c, Gen&lt;d&gt; d, Gen&lt;e&gt; e)</code>
</dd>
<dd><code>Gen&lt;g&gt; Map6&lt;a, b, c, d, e, f, g&gt;(FSharpFunc&lt;a, FSharpFunc&lt;b, FSharpFunc&lt;c, FSharpFunc&lt;d, FSharpFunc&lt;e, FSharpFunc&lt;f, g&gt;&gt;&gt;&gt;&gt;&gt; f, Gen&lt;a&gt; a, Gen&lt;b&gt; b, Gen&lt;c&gt; c, Gen&lt;d&gt; d, Gen&lt;e&gt; e, Gen&lt;f&gt; g)</code>
</dd>
<dt>OneOf</dt>
<dd>Build a generator that generates a value from one of the given generators, with equal probability
</dd>
<dd><code>Gen&lt;a&gt; OneOf&lt;a&gt;(IEnumerable&lt;Gen&lt;a&gt;&gt; gens)</code>
</dd>
<dd><code>Gen&lt;a&gt; OneOf&lt;a&gt;(params Gen&lt;a&gt;[] generators)</code>
</dd>
<dt>optionOf</dt>
<dd>Generate an option value that is âNoneâ 1/8 of the time.
</dd>
<dd><code>Gen&lt;FSharpOption&lt;a&gt;&gt; optionOf&lt;a&gt;(Gen&lt;a&gt; g)</code>
</dd>
<dt>Piles</dt>
<dd>Generates a random array of length k where the sum of all elements equals the given sum.
</dd>
<dd><code>Gen&lt;int[]&gt; Piles(int k, int sum)</code>
</dd>
<dt>Resize</dt>
<dd>Override the current size of the test. resize n g invokes generator g with size parameter n.
</dd>
<dd><code>Gen&lt;a&gt; Resize&lt;a&gt;(int newSize, Gen&lt;a&gt; _arg1)</code>
</dd>
<dt>Sample</dt>
<dd>Generates n values of the given size.
</dd>
<dd><code>FSharpList&lt;a&gt; Sample&lt;a&gt;(int size, int n, Gen&lt;a&gt; generator)</code>
</dd>
<dt>ScaleSize</dt>
<dd>Modify a size using the given function before passing it to the given Gen.
</dd>
<dd><code>Gen&lt;a&gt; ScaleSize&lt;a&gt;(FSharpFunc&lt;int, int&gt; f, Gen&lt;a&gt; g)</code>
</dd>
<dt>Sequence</dt>
<dd>Convert the given value generators into a generator of a sequence of values
</dd>
<dd><code>Gen&lt;IEnumerable&lt;a&gt;&gt; Sequence&lt;a&gt;(IEnumerable&lt;Gen&lt;a&gt;&gt; generators)</code>
</dd>
<dd><code>Gen&lt;a[]&gt; Sequence&lt;a&gt;(params Gen&lt;a&gt;[] generators)</code>
</dd>
<dt>SequenceToList</dt>
<dd>Sequence the given enumerable of generators into a generator of a list.
</dd>
<dd><code>Gen&lt;FSharpList&lt;a&gt;&gt; SequenceToList&lt;a&gt;(IEnumerable&lt;Gen&lt;a&gt;&gt; l)</code>
</dd>
<dt>Shuffle</dt>
<dd>Generates a random permutation of the given sequence.
</dd>
<dd><code>Gen&lt;a[]&gt; Shuffle&lt;a&gt;(IEnumerable&lt;a&gt; xs)</code>
</dd>
<dt>Sized</dt>
<dd>Obtain the current size
</dd>
<dd><code>Gen&lt;a&gt; Sized&lt;a&gt;(FSharpFunc&lt;int, Gen&lt;a&gt;&gt; fgen)</code>
</dd>
<dd><code>Gen&lt;a&gt; Sized&lt;a&gt;(Func&lt;int, Gen&lt;a&gt;&gt; sizedGen)</code>
</dd>
<dt>Unzip</dt>
<dd>Split a generator of tuples into a tuple of generators.
</dd>
<dd><code>Tuple&lt;Gen&lt;a&gt;, Gen&lt;b&gt;&gt; Unzip&lt;a, b&gt;(Gen&lt;Tuple&lt;a, b&gt;&gt; g)</code>
</dd>
<dd><code>Tuple&lt;Gen&lt;a&gt;, Gen&lt;b&gt;, Gen&lt;c&gt;&gt; Unzip&lt;a, b, c&gt;(Gen&lt;Tuple&lt;a, b, c&gt;&gt; g)</code>
</dd>
<dt>Zip</dt>
<dd>Combine generators into a generator of Tuples
</dd>
<dd><code>Gen&lt;Tuple&lt;a, b&gt;&gt; Zip&lt;a, b&gt;(Gen&lt;a&gt; f, Gen&lt;b&gt; g)</code>
</dd>
<dd><code>Gen&lt;Tuple&lt;a, b, c&gt;&gt; Zip&lt;a, b, c&gt;(Gen&lt;a&gt; f, Gen&lt;b&gt; g, Gen&lt;c&gt; h)</code>
</dd>
</dl>
<h2 id="shrinker"><span class="header-section-number">3.2</span> Shrinker</h2>
<h2 id="arbitrary"><span class="header-section-number">3.3</span> Arbitrary</h2>
<p>FsCheck uses <code>Arbitrary</code> to package a generator and shrinker for a type. You can define custom <code>Arbitrary</code> instances for you own types by defining static members that return an instance of <code>Arbitrary&lt;'a&gt;</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">public</span> <span class="kw">class</span> MyGenerators</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">    <span class="kw">public</span> <span class="kw">static</span> Gen&lt;MyType&gt; <span class="fu">GenerateMyType</span>()</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">    {</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">        <span class="kw">return</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6">            Gen</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">            .<span class="fu">Sized</span>(size =&gt;</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">                Gen</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">                .<span class="fu">Choose</span>(<span class="dv">0</span>, size)</a>
<a class="sourceLine" id="cb23-10" data-line-number="10">                .<span class="fu">Select</span>(value =&gt; <span class="kw">new</span> <span class="fu">MyType</span>() { AValue = value }));</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">    }</a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13">    <span class="kw">public</span> Arbitrary&lt;MyType&gt; <span class="fu">MyTypes</span>()</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">    {</a>
<a class="sourceLine" id="cb23-15" data-line-number="15">        <span class="kw">return</span> Arb.<span class="fu">From</span>(<span class="fu">GenerateMyType</span>());</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">    }</a>
<a class="sourceLine" id="cb23-17" data-line-number="17">}</a></code></pre></div>
<p>FsCheck organizes <code>Arbitrary</code> instances in a <code>&lt;Type, Arbitrary&gt;</code> dictionary. To use the arbitrary generator you register it:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb24-1" data-line-number="1">Arb.<span class="fu">Register</span>&lt;MyGenerators&gt;();</a></code></pre></div>
<h3 id="arb-methods"><span class="header-section-number">3.3.1</span> <code>Arb</code> methods</h3>
<dl>
<dt>Convert</dt>
<dd>Construct an Arbitrary instance for a type that can be mapped to and from another type (e.g.Â a wrapper), based on a Arbitrary instance for the source type and two mapping functions :
</dd>
<dd><code>Arbitrary&lt;b&gt; Convert&lt;a, b&gt;(FSharpFunc&lt;a, b&gt; convertTo, FSharpFunc&lt;b, a&gt; convertFrom, Arbitrary&lt;a&gt; a)</code>
</dd>
<dt>Filter</dt>
<dd>Return an Arbitrary instance that is a filtered version of an existing arbitrary instance. The generator uses Gen.suchThat, and the shrinks are filtered using Seq.filter with the given predicate.
</dd>
<dd><code>Arbitrary&lt;a&gt; Filter&lt;a&gt;(FSharpFunc&lt;a, bool&gt; pred, Arbitrary&lt;a&gt; a)</code>
</dd>
<dt>From</dt>
<dd>Get the Arbitrary instance for the given type
</dd>
<dd><code>Arbitrary&lt;Value&gt; From&lt;Value&gt;()</code>
</dd>
<dd>Construct an Arbitrary instance from a generator. Shrink is not supported for this type.
</dd>
<dd><code>Arbitrary&lt;Value&gt; From&lt;Value&gt;(Gen&lt;Value&gt; gen)</code>
</dd>
<dd>Construct an Arbitrary instance from a generator and shrinker.
</dd>
<dd><code>Arbitrary&lt;Value&gt; From&lt;Value&gt;(Gen&lt;Value&gt; gen, FSharpFunc&lt;Value, IEnumerable&lt;Value&gt;&gt; shrinker)</code>
</dd>
<dd><code>Arbitrary&lt;Value&gt; From&lt;Value&gt;(Gen&lt;Value&gt; gen, Func&lt;Value, IEnumerable&lt;Value&gt;&gt; shrinker)</code>
</dd>
<dt>MapFilter</dt>
<dd>Return an Arbitrary instance that is a mapped and filtered version of an existing arbitrary instance. The generator uses Gen.map with the given mapper and then Gen.suchThat with the given predicate, and the shrinks are filtered using Seq.filter with the given predicate. This is sometimes useful if using just a filter would reduce the chance of getting a good value from the generator - and you can map the value instead. E.g. PositiveInt.
</dd>
<dd><code>Arbitrary&lt;a&gt; MapFilter&lt;a&gt;(FSharpFunc&lt;a, a&gt; mapper, FSharpFunc&lt;a, bool&gt; pred, Arbitrary&lt;a&gt; a)</code>
</dd>
<dt>Register</dt>
<dd>Register the generators that are static members of the type
</dd>
<dd><code>TypeClass.TypeClassComparison Register(Type t)</code>
</dd>
<dd><code>TypeClass.TypeClassComparison Register&lt;t&gt;()</code>
</dd>
<dt>Generate</dt>
<dd>Return a generator
</dd>
<dd><code>Gen&lt;Value&gt; Generate&lt;Value&gt;()</code>
</dd>
<dt>Shrink</dt>
<dd>Returns the immediate shrinks for the given value based on its type.
</dd>
<dd><code>IEnumerable&lt;Value&gt; Shrink&lt;Value&gt;(Value a)</code>
</dd>
<dt>shrinkNumber</dt>
<dd>A generic shrinker that should work for most number-like types
</dd>
<dd><code>IEnumerable&lt;a&gt; shrinkNumber&lt;a, b, c, d&gt;(a n)</code>
</dd>
<dt>Default</dt>
<dd>Type containing all the default <code>Arbitrary</code> instances as they are shipped and registered by FsCheck.
</dd>
<dd><code>Arb.Defualt</code>
</dd>
</dl>
<h1 id="bibliography"><span class="header-section-number">4</span> Bibliography</h1>
<h4 id="section"><span class="header-section-number">4.0.0.1</span> [1]</h4>
<p>Koen Claessen and John Hughes. <strong>QuickCheck: A Lightweight Tool for Random Testing of Haskell Programs</strong>. In: Proceedings of the ACM SIGPLAN International Conference on Functional Programming, ICFP 46 (Jan.Â 2000). DOI: 10.1145/1988042.1988046.</p>
<h4 id="section-1"><span class="header-section-number">4.0.0.2</span> [2]</h4>
<p>Richard Hamlet. <strong>Random Testing</strong>. In: Encyclopedia of Software Engineering. Wiley, 1994, pp.Â 970â978.</p>
<h4 id="section-2"><span class="header-section-number">4.0.0.3</span> [3]</h4>
<p><strong>FsCheck</strong>. <a href="https://fscheck.github.io/FsCheck/index.html" class="uri">https://fscheck.github.io/FsCheck/index.html</a>.</p>
<h4 id="section-3"><span class="header-section-number">4.0.0.4</span> [4]</h4>
<p><strong>Property-Based Testing with C#</strong>. <a href="https://www.codit.eu/blog/property-based-testing-with-c/?country_sel=be" class="uri">https://www.codit.eu/blog/property-based-testing-with-c/?country_sel=be</a>.</p>
</article>
</body>
</html>
